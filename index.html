<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="style.css" />

        <title>Animal Noise Drum Machine</title>
    </head>
    <body>
        <div id="drum-machine">
            <div id="display">
                <h2 id="current-sound-display">
                    &nbsp;
                </h2>
            </div>
            
            <div id="drum-pads">
                <div data-key="81" class="drum-pad" data-emoji="🐴" id="horse">
                    <kbd>Q</kbd>
                    <audio data-key="81" class="clip" id="Q" src="sounds/horse.wav"></audio>                 
                </div>
                <div data-key="87" class="drum-pad" data-emoji="🐸" id="frog">
                    <kbd>W</kbd>
                    <audio data-key="87" class="clip" id="W" src="sounds/frog.mp3"></audio>   
                </div>
                <div data-key="69" class="drum-pad" data-emoji="🐱" id="cat">
                    <kbd>E</kbd>
                    <audio data-key="69" class="clip" id="E" src="sounds/cat.wav"></audio> 
                </div>

                <div data-key="65" class="drum-pad" data-emoji="🐶" id="dog">
                    <kbd>A</kbd>
                    <audio data-key="65" class="clip" id="A" src="sounds/dog.wav"></audio> 
                </div>
                <div data-key="83" class="drum-pad" data-emoji="🐘" id="elephant">
                    <kbd>S</kbd>
                    <audio data-key="83" class="clip" id="S" src="sounds/elephant.wav"></audio> 
                </div>
                <div data-key="68" class="drum-pad" data-emoji="🦅" id="hawk">
                    <kbd>D</kbd>
                    <audio data-key="68" class="clip" id="D" src="sounds/hawk.wav"></audio> 
                </div>

                <div data-key="90" class="drum-pad" data-emoji="🐑" id="sheep">
                    <kbd>Z</kbd>
                    <audio data-key="90" class="clip" id="Z" src="sounds/sheep.wav"></audio> 
                </div>
                <div data-key="88" class="drum-pad" data-emoji="🦃" id="turkey">
                    <kbd>X</kbd>
                    <audio data-key="88" class="clip" id="X" src="sounds/turkey.wav"></audio> 
                </div>
                <div data-key="67" class="drum-pad" data-emoji="🦖" id="tyrannosaurus">
                    <kbd>C</kbd>
                    <audio data-key="67" class="clip" id="C" src="sounds/tyrannosaurus.wav"></audio> 
                </div>
            </div>

            <div class="directions">
                <h3>Directions:</h3> 
                <p>
                    1. Turn your sound on
                    2. Choose (with keyboard or mouse) a letter
                </p>
            </div>
        </div>

        <script>
            function handleEvent(e) {
                let keyCode;

                if (e.type === "click") {
                    e = Array.from(e.path).find(el => el.className === "drum-pad");
                    keyCode = Number(e.getAttribute("data-key"));
                } else {
                    keyCode = e.keyCode;
                }

                const audio = document.querySelector(`audio[data-key="${keyCode}"]`);
                const drumPad = document.querySelector(`div[data-key="${keyCode}"]`);
                if (!audio) return;

                drumPad.classList.add('playing');
                audio.currentTime = 0;
                audio.play();          

                const display = document.getElementById("current-sound-display");
                display.innerText = drumPad.getAttribute('data-emoji')    
            }

            function removeTransition(e) {
                if (e.propertyName !== 'transform') return;
                e.target.classList.remove('playing');
            }

            window.addEventListener('keydown', handleEvent);
            

            const drumPads = Array.from(document.querySelectorAll('.drum-pad'));
            drumPads.forEach(drumPad => drumPad.addEventListener('transitionend', removeTransition));
            drumPads.forEach(drumPad => drumPad.addEventListener('keydown', removeTransition));
            drumPads.forEach(drumPad => drumPad.onclick = handleEvent);

        </script>
        <script src="https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js"></script>
    </body>
</html>